<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <!--
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print">
    -->
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">
    <link rel="stylesheet" type="text/css" href="/css/main.css" media="screen">

    <title>DongInn's Notes</title>
  </head>

  <body>

    <header>
      <div id="header">
        <div id="header-title">
          <h1>DongInn's Notes</h1>
          <h2>./configure</h2>
                  <ul class="blue">
            <li><a href="/" title="home" class="" ><span>Home</span></a></li>
            <li><a href="/configure" title="configure" class="" ><span>Configure</span></a></li>
            <li><a href="/blog" title="blog" class="current" ><span>Blog</span></a></li>
            <!--
            <li><a href="/contact" title="contact" class="" ><span>Contact</span></a></li>
            -->
            <li><a href="/publications" title="contact" class="" ><span>Publications</span></a></li>
        </ul>


        </div>

        <!--
        <section id="downloads">
          <a href="https://github.com/dikim33" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
        -->
      </div>
    </header>
    <div class="container">
      <section id="main_content">

<div id="second-header">
  <ul class="blue">
    <li><a href="/apple_blog" title="apple" class="" ><span>Apple</span></a></li>
    <li><a href="/linux_blog" title="linux" class="current" ><span>Linux</span></a></li>
  </ul>
</div>

<h1>Simple Scripts</h1>

<h3> lsof </h3>
<p>Sometimes my system is in trouble with the high loadaverage of the web server because of the attack of some malicious IPs.<br />
I have tried to look for a command to get the IPs which make this kind of trouble by looking into its pid.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">      lsof -nP -w -T -i tcp | grep httpd | grep &lt;PROCESS_ID_TO_CHECK&gt;</code></pre></figure>

<h3> diff </h3>
<p>Sometimes I want to find the diffs between my local file and remote file or between remote files. Here is a simple trick.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">      diff &lt;LOCAL_FILE &lt;<span class="o">(</span>ssh remote_host_1 cat REMOTE_FILE<span class="o">)</span>
      diff &lt;<span class="o">(</span>ssh remote_host_1 cat REMOTE_FILE_1<span class="o">)</span>  &lt;<span class="o">(</span>ssh remote_host_2 cat REMOTE_FILE_2<span class="o">)</span></code></pre></figure>

<p>(Note, where remote_host_1 and remote_host_2 should be setup with your ssh-key stuff and you should not need to put your password or passphrase. Unfortunately, this works only on bash)</p>

<h3> dump and restore </h3>
<p>dump and restore are a sysadminâ€™s friend. They really make it easy for sysadmin to handle the backup of a system. There may be some applications to replace the command dump and restore but I would like to be stuck with them untli I find something better than them.\ Do you know that we can simply dump the whole partition and restore it on the remote machine? So, we can migrate the whole system with a following simple script using dump and restore</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">      ssh remote_host<span class="o">(</span>_IP<span class="o">)</span> -n dump 0cf - / | restore xf -</code></pre></figure>

<p>I found this tip when <a href="http://www.cs.indiana.edu/~shei">Bruce</a>, the CS sysadmins at IU, helped to migrate one of the very important servers of the OSL. I would like to give special thanks to Bruce.</p>

<p><strong>Note</strong></p>

<ul>
  <li>The target machine where you want to migrate a system should be clean(or empty) to take the whole system of the remote machine assuming it has enough space to restore the dump file.</li>
  <li>Reboot your target machine to go to a single-user mode. (e.g., I usually do with my linux installation CD)</li>
  <li>Run the above script at the target machine.</li>
  <li>Of course, the ssh-key stuff should be setup without having to put your password or passphrase.</li>
</ul>

<h3> Mount ISO file </h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">mount -o loop -t iso9660 file.iso /mnt/test</code></pre></figure>





      </section>
      <footer>
        <div id="footer">
        <table>
          <tr>
            <td><span style="display: block !important; width: 300px; text-align: left; font-family: sans-serif; font-size: 12px;"><a href="http://www.wunderground.com/cgi-bin/findweather/getForecast?query=zmw:47401.1.99999&bannertypeclick=wu_clean2day" title="Bloomington, Indiana Weather Forecast" target="_blank"><img src="http://weathersticker.wunderground.com/weathersticker/cgi-bin/banner/ban/wxBanner?bannertype=wu_clean2day_cond&airportcode=KBMG&ForcedCity=Bloomington&ForcedState=IN&zip=47401&language=EN" alt="Find more about Weather in Bloomington, IN" width="200" /></a><br><a href="http://www.wunderground.com/cgi-bin/findweather/getForecast?query=zmw:47401.1.99999&bannertypeclick=wu_clean2day" title="Get latest Weather Forecast updates" style="font-family: sans-serif; font-size: 12px" target="_blank">Click for weather forecast</a></span></td>
            <td style="text-align:right">Updated: 2017-03-13</td>
          </tr>
        </table>
      </div>
      </footer>
    </div>
  </body>
</html>
